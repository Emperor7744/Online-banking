(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6985],{46357:(e,t,a)=>{Promise.resolve().then(a.bind(a,46569)),Promise.resolve().then(a.bind(a,22284)),Promise.resolve().then(a.bind(a,52041)),Promise.resolve().then(a.bind(a,59361)),Promise.resolve().then(a.bind(a,14834)),Promise.resolve().then(a.bind(a,37023)),Promise.resolve().then(a.bind(a,95791))},51556:(e,t,a)=>{"use strict";a.d(t,{E:()=>h,i:()=>x});var l=a(54857),s=a(12350),r=a(90703),n=a(12051),i=a(4473),o=a(94933),c=a(71368),d=a(44658),u=a(90080),m=a(26970);let h={private:{babyIcon:(0,l.jsx)(n.F,{size:14}),icon:(0,l.jsx)(i.C,{})},team:{babyIcon:(0,l.jsx)(r.z,{className:"p-[3px]",size:16}),icon:(0,l.jsx)(r.z,{})},"team-edit":{babyIcon:(0,l.jsx)(r.z,{className:"p-[3px]",size:16}),icon:(0,l.jsx)(r.z,{}),visibleInPicker:!1},unlisted:{babyIcon:(0,l.jsx)(o.N,{className:"p-[3px]",size:16}),icon:(0,l.jsx)(o.N,{})},public:{babyIcon:(0,l.jsx)(s.q,{className:"p-[3px]",size:16}),icon:(0,l.jsx)(s.q,{})}};function x(e){let{chatId:t,privacy:a}=e,s=(0,c.k)("chatPrivacy"),{setShareDialog:r}=(0,u.B)();return a&&t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(d.E,{className:"pointer-events-auto hidden gap-0 text-[11px] sm:flex",onClick:()=>r({chatId:t,privacy:a}),size:"sm",variant:"outline",children:[h[a].babyIcon,(0,l.jsx)("p",{children:s("label",a)})]}),(0,l.jsx)(m.Tooltip,{content:s("label",a),children:(0,l.jsx)("button",{className:"flex sm:hidden",onClick:()=>r({chatId:t,privacy:a}),children:h[a].icon})})]}):null}},46569:(e,t,a)=>{"use strict";a.d(t,{DeleteChatDialog:()=>v,v:()=>j});var l=a(54857),s=a(16617),r=a(77184),n=a(3316),i=a(80612),o=a(96541),c=a(73927),d=a(41773),u=a(38651),m=a(12098),h=a(3128),x=a(58658),f=a(71368),p=a(19763),g=a(77170);function j(){let{data:e,mutate:t}=(0,i.Ay)("showDeleteDialogForChatId",null);return{showDeleteDialogForChatId:e,setDeleteDialogForChatId:t}}function v(){let{showDeleteDialogForChatId:e,setDeleteDialogForChatId:t}=j(),a=(0,c.useRouter)(),i=(0,x.cy)(),[v,b]=(0,o.useTransition)(),{setData:y}=(0,d.m)(),{setMobileSheetOpen:N}=(0,h.e)(),w=(0,f.k)("deleteChatDialog");return(0,l.jsxs)(n.Modal,{onOpenChange:e=>{e||t(void 0)},open:void 0!==e,children:[(0,l.jsxs)(n.ModalHeader,{children:[(0,l.jsx)(n.ModalTitle,{children:w("title")}),(0,l.jsx)(n.ModalDescription,{children:w("description")})]}),(0,l.jsxs)(n.ModalFooter,{children:[(0,l.jsx)(n.ModalClose,{asChild:!0,children:(0,l.jsx)(s.$,{size:"sm",variant:"secondary",children:w("cancel")})}),(0,l.jsx)(s.$,{disabled:v,onClick:()=>{e&&b(async()=>{try{(0,u.u)("ClickDeleteChat",{targetChatId:e}),await (0,m._)({payload:{chatId:e}}),y(t=>t.filter(t=>t.chatId!==e)),t(void 0),r.oR.success(w("successToast")),i.id===e&&(N(!1),a.push("/chat"))}catch(e){(0,g.z)(e)||r.oR.error("Something went wrong. Please try again.")}})},size:"sm",variant:"destructive",children:v?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.X,{className:"size-4"}),w("deleting")]}):w("delete")})]})]})}},90080:(e,t,a)=>{"use strict";a.d(t,{B:()=>v,default:()=>y,w:()=>b});var l=a(54857),s=a(80612),r=a(16617),n=a(62841),i=a(77184),o=a(34227),c=a(90761),d=a(3316),u=a(33744),m=a(94933),h=a(67964),x=a(71368),f=a(56720),p=a(43706),g=a(43393),j=a(47747);function v(){let{data:e,mutate:t}=(0,s.Ay)("showShareDialog",null,{fallbackData:!1});return{showShareDialog:e,setShareDialog:t}}function b(e){let{isAuthor:t,...a}=e,{setShareDialog:s}=v(),{chatPrivacy:r}=(0,c.kM)(),{copyToClipboard:n}=(0,o.C)({timeout:2e3}),d=(0,x.k)("shareDialog");return"private"!==r||t?(0,l.jsxs)(p._2,{onClick:()=>{t?s(!0):("public"===r||"team"===r)&&(n(window.location.href),i.oR.success("Share link copied!"))},...a,children:[(0,l.jsx)(h.S,{}),(0,l.jsx)("span",{children:d("share")})]}):null}function y(){let e=(0,x.k)("shareDialog"),{isTeam:t}=(0,g.k6)(),{chatId:a}=(0,n.xz)(),{chatPrivacy:s}=(0,c.kM)(),{title:i}=(0,c.tZ)(),{showShareDialog:h,setShareDialog:p}=v(),{isCopied:b,copyToClipboard:y}=(0,o.C)({timeout:2e3}),{chatId:N,privacy:w}="object"==typeof h?h:{chatId:a,privacy:s};return N?(0,l.jsxs)(d.Modal,{onOpenAutoFocus:e=>{e.preventDefault();let t=document.querySelector(".privacy-picker-selected");t&&t.focus()},onOpenChange:e=>{e||p(!1)},open:!!h,children:[(0,l.jsxs)(d.ModalHeader,{children:[(0,l.jsx)(d.ModalTitle,{children:e("title")}),(0,l.jsxs)("p",{className:"text-foreground text-sm",children:[" ","Keep this chat private"," ",(0,l.jsx)("span",{children:t&&", share it with your team,"})," or make it publicly accessible."]})]}),(0,l.jsx)(d.ModalContent,{className:"p-6",children:(0,l.jsx)(f.f,{privacy:w,chatId:N,variant:"chat"})}),(0,l.jsxs)(d.ModalFooter,{className:"bg-muted border-alpha-400 border-t !p-4",children:[(0,l.jsxs)(r.$,{onClick:()=>{y("".concat(window.location.origin,"/chat/").concat((0,j.D)(N,i)))},size:"sm",variant:"secondary",children:[(0,l.jsx)(u.U,{customIcon:(0,l.jsx)(m.N,{}),isCopied:b}),e("copyLink")]}),(0,l.jsx)(d.ModalClose,{asChild:!0,children:(0,l.jsx)(r.$,{tabIndex:0,size:"sm",children:e("done")})})]})]}):null}},22284:(e,t,a)=>{"use strict";a.d(t,{C:()=>U,ImportFromFigmaModal:()=>F});var l=a(54857),s=a(96541),r=a(3316),n=a(16617),i=a(86287),o=a(10373),c=a(4423),d=a(71857),u=a(63694),m=a(48774),h=a(46948),x=a(97682),f=a(53317),p=a(38651),g=a(71368),j=a(30856),v=a(13534),b=a(52041),y=a(80612),N=a(44658),w=a(67401),C=a(45881);function k(e){let{inputRef:t,inputValue:a,setInputValue:s,urlError:c,setUrlError:u,handleImport:p,handleClose:j,isLoading:v}=e,b=(0,g.k)("figmaIntegration");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.ModalHeader,{className:"flex justify-start p-5",children:(0,l.jsxs)("div",{className:"flex w-full flex-col items-start gap-2",children:[(0,l.jsxs)("div",{className:"bg-muted/50 relative h-[180px] w-full rounded-md",children:[(0,l.jsx)(m.default,{src:"/chat-static/figma-integration-light.svg",alt:"",className:"h-full w-full rounded-md object-cover dark:hidden",fill:!0,priority:!0}),(0,l.jsx)(m.default,{src:"/chat-static/figma-integration-dark.svg",alt:"",className:"hidden h-full w-full rounded-md object-cover dark:block",fill:!0,priority:!0})]}),(0,l.jsxs)("div",{className:"flex w-full flex-col items-start gap-2",children:[(0,l.jsx)(r.ModalTitle,{className:"text-xl font-semibold",children:b("importFromFigma")}),(0,l.jsxs)("form",{className:"flex w-full flex-col space-y-3",onSubmit:e=>{e.preventDefault(),p()},children:[(0,l.jsx)("div",{className:"text-left text-sm text-gray-900",children:(0,l.jsx)(r.ModalDescription,{children:b("importFigmaDescription")})}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)(i.p,{ref:t,type:"url",size:"sm",placeholder:b("enterFigmaUrl"),className:(0,f.cn)("bg-subtle w-full",c&&"border-red-500"),value:a,onChange:e=>{s(e.target.value),c&&u(null)}}),(0,l.jsx)(h.N,{mode:"sync",children:c&&(0,l.jsx)(x.P.div,{initial:{height:0,opacity:0,y:-8},animate:{height:"auto",opacity:1,y:0},exit:{height:0,opacity:0,y:-8},transition:{duration:.15,ease:"easeOut"},children:(0,l.jsxs)("span",{className:"flex items-center gap-2 whitespace-nowrap text-red-500",children:[(0,l.jsx)(d.V,{className:"h-4 w-4 shrink-0"}),(0,l.jsx)("span",{className:"truncate text-sm",children:c})]})})})]})]})]})]})}),(0,l.jsx)(r.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:(0,l.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[(0,l.jsx)(r.ModalClose,{asChild:!0,disabled:v,children:(0,l.jsx)(n.$,{onClick:j,size:"sm",variant:"secondary",disabled:v,children:b("cancel")})}),(0,l.jsx)(o.Q,{onClick:p,size:"sm",pending:v,autoFocus:!0,children:b("next")})]})})]})}function S(e){let{color:t}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded-md border p-1",children:[(0,l.jsx)("div",{className:"h-4 w-4 rounded-sm border",style:{backgroundColor:t.hex}}),(0,l.jsx)("div",{className:"flex flex-col",children:(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:t.hex.toLowerCase()})})]})}function I(e){let{imageBase64:t,originalFigmaUrl:a,nodeContext:s,handleImport:i,handleClose:d,isLoading:h,imageHeight:x}=e,f=(0,g.k)("figmaIntegration");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"max-h-[calc(100vh-8rem)] overflow-y-auto",children:(0,l.jsx)(r.ModalHeader,{className:"flex w-full flex-col p-3 md:p-5",children:(0,l.jsxs)("div",{className:"flex w-full flex-col gap-3 md:gap-4",children:[(0,l.jsx)(r.ModalTitle,{className:"text-left text-lg font-semibold md:text-xl",children:f("heresWhatWellImport")}),(0,l.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,l.jsx)("h3",{className:"text-left text-sm font-medium md:text-base",children:f("visualContext")}),x&&x/2>982&&(0,l.jsxs)(C.Fc,{children:[(0,l.jsx)(u.A,{className:"h-4 w-4"}),(0,l.jsx)(C.TN,{children:f("heightWarning")})]}),(0,l.jsx)("div",{className:"bg-muted/50 relative h-[200px] w-full rounded-md border md:h-[400px]",children:t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.default,{src:t,alt:"Figma design preview",className:"rounded-md object-cover object-top",fill:!0,sizes:"100vw",priority:!0}),(0,l.jsx)("div",{className:"absolute bottom-2 right-2 z-10 md:bottom-3 md:right-3",children:(0,l.jsx)(w.N,{href:a,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),passHref:!0,children:(0,l.jsxs)(N.E,{className:"bg-muted hover:bg-muted/50 max-w-[200px] cursor-pointer truncate text-xs md:text-sm",variant:"secondary",children:[(0,l.jsx)(c.Y,{className:"h-3 w-3 shrink-0"}),(0,l.jsx)("span",{className:"truncate",children:s.frameName||f("openInFigma")})]})})})]})}),(0,l.jsx)("div",{className:"mt-3 flex flex-col space-y-3",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:gap-6",children:[s.nodes.designTokens.length>0&&(0,l.jsxs)("div",{className:"mb-6 flex flex-1 flex-col gap-2 md:mb-0",children:[(0,l.jsx)("h3",{className:"text-left text-sm font-medium md:text-base",children:f("designTokens")}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:s.nodes.designTokens.map((e,t)=>(0,l.jsx)(S,{color:e},e.hex||t))})]}),s.nodes.colors.length>0&&(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,l.jsx)("h3",{className:"text-left text-sm font-medium md:text-base",children:f("colors")}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:s.nodes.colors.map((e,t)=>(0,l.jsx)(S,{color:e},e.hex||t))})]})]})})]})]})})}),(0,l.jsx)(r.ModalFooter,{className:"border-border bg-muted sticky bottom-0 border-t !p-3 md:!p-4",children:(0,l.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[(0,l.jsx)(r.ModalClose,{asChild:!0,disabled:h,children:(0,l.jsx)(n.$,{onClick:d,size:"sm",variant:"secondary",disabled:h,children:f("cancel")})}),(0,l.jsx)(o.Q,{onClick:i,size:"sm",pending:h,autoFocus:!0,children:f("confirm")})]})})]})}function F(){var e;let{importFigmaModalOpen:t,setImportFigmaModalOpen:a}=U(),{setSignInWithFigmaModal:n}=(0,b.f)(),[i,o]=(0,s.useState)("url"),[c,d]=(0,s.useState)(null),[u,m]=s.useState(null),h=s.useRef(null),[x,g]=s.useState(""),[y,N]=s.useState(""),w=(0,v.q)(h),{fia:C}=(0,j.D)();(0,s.useEffect)(()=>{if((null==t?void 0:t.open)&&!w.isSignedIn){var e,l;a(null),n({figmaOauthUrl:"".concat(null!==(l=null===(e=w.userData)||void 0===e?void 0:e.figmaOauthUrl)&&void 0!==l?l:"","&from=import")})}},[w.isSignedIn,null==t?void 0:t.open,a,n,null===(e=w.userData)||void 0===e?void 0:e.figmaOauthUrl]);let S=()=>{a(null),m(null),g(""),o("url"),h.current&&(h.current.value="")},F=()=>{S(),(0,p.u)("FigmaModalClose")},M=async()=>{if(!x){let e="Please enter a Figma URL";m(e),(0,p.u)("FigmaUrlSubmit",{url:"",success:!1,error:e});return}try{C?await z(x):await E(x)}catch(e){(0,p.u)("FigmaUrlSubmit",{url:x,success:!1,error:e instanceof Error?e.message:"Unknown error"})}},z=async e=>{if("url"===i){if(w.isFigmaUrl(e))try{let[t,a]=await Promise.all([w.getNodeContext(e),w.handleFigmaUrl(e)]);a.success?(d(t),N(a.data.base64),m(null),o("context")):m(a.error||"Invalid Figma URL")}catch(e){m("Error loading Figma content")}else m("Please enter a valid Figma URL")}else(await w.handleFigmaUrl(e)).success&&(null==t?void 0:t.onImport)&&(F(),await t.onImport(e),(0,p.u)("FigmaUrlSubmit",{url:e,success:!0}))},E=async e=>{w.isFigmaUrl(e)?(await w.handleFigmaUrl(e)).success&&(null==t?void 0:t.onImport)?(F(),await t.onImport(e),(0,p.u)("FigmaUrlSubmit",{url:e,success:!0})):((0,p.u)("FigmaUrlSubmit",{url:e,success:!1,error:"Invalid Figma URL"}),m("Invalid Figma URL")):m("Please enter a valid Figma URL")};return t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Modal,{onClose:F,onOpenChange:w.isLoading?void 0:S,open:!!t,className:(0,f.cn)("w-full",C?"url"===i?"max-w-xl":"md:!w-[800px]":"max-w-xl"),children:(0,l.jsx)("div",{className:"flex w-full flex-col",children:C&&c?"url"===i?(0,l.jsx)(k,{inputRef:h,inputValue:x,setInputValue:g,urlError:u,setUrlError:m,handleImport:M,handleClose:F,isLoading:w.isLoading}):(0,l.jsx)(I,{imageBase64:y,originalFigmaUrl:x,nodeContext:c,handleImport:M,handleClose:F,isLoading:w.isLoading,imageHeight:w.imageHeight}):(0,l.jsx)(k,{inputRef:h,inputValue:x,setInputValue:g,urlError:u,setUrlError:m,handleImport:M,handleClose:F,isLoading:w.isLoading})})}),(0,l.jsx)(b.default,{})]}):null}function U(){let{data:e,mutate:t}=(0,y.Ay)("useImportFromFigmaModal",null);return{importFigmaModalOpen:e,setImportFigmaModalOpen:t,figmaContext:null==e?void 0:e.figmaContext}}},52041:(e,t,a)=>{"use strict";a.d(t,{default:()=>m,f:()=>h});var l=a(54857),s=a(96541),r=a(3316),n=a(16617),i=a(80612),o=a(4423),c=a(71368),d=a(38651),u=a(73927);function m(){let e=(0,c.k)("figmaIntegration"),{figmaOauthUrl:t,setSignInWithFigmaModal:a}=h(),i=(0,u.usePathname)()+(0,u.useSearchParams)().toString(),m=(0,u.useRouter)();(0,s.useEffect)(()=>{t&&(0,d.u)("FigmaAuthModalOpen")},[t]);let x=e=>{(0,d.u)("FigmaAuthModalClose",{reason:e}),a(null)},f=async()=>{let e=await fetch("/chat/api/integrations/figma/get-oauth-url?returnPath=".concat(encodeURIComponent(i))).then(e=>e.json()).then(e=>e.url);m.push(e)};return t?(0,l.jsx)(r.Modal,{onOpenChange:e=>!e&&x("cancel"),open:!!t,children:(0,l.jsxs)("div",{className:"grid gap-6",children:[(0,l.jsx)(r.ModalHeader,{className:"flex justify-start p-5",children:(0,l.jsxs)("div",{className:"flex w-full flex-col items-start gap-4",children:[(0,l.jsx)("div",{className:"bg-muted border-border flex items-center gap-2 rounded-lg p-2",children:(0,l.jsx)("div",{className:"rounded-lg border bg-white p-2",children:(0,l.jsx)(o.Y,{className:"text-muted-foreground h-6 w-6"})})}),(0,l.jsxs)("div",{className:"flex flex-col items-start gap-1.5",children:[(0,l.jsx)(r.ModalTitle,{className:"text-xl font-semibold",children:e("signInWithFigma")}),(0,l.jsx)(r.ModalDescription,{className:"text-sm text-zinc-500",children:e("signInDescription")})]})]})}),(0,l.jsx)(r.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:(0,l.jsxs)("div",{className:"flex w-full items-center justify-end gap-4",children:[(0,l.jsx)(r.ModalClose,{asChild:!0,children:(0,l.jsx)(n.$,{onClick:()=>x("cancel"),size:"sm",variant:"secondary",children:e("cancel")})}),(0,l.jsx)(n.$,{onClick:f,size:"sm",variant:"default",autoFocus:!0,children:e("signIn")})]})})]})}):null}function h(){let{data:e,mutate:t}=(0,i.Ay)("signInWithFigmaModal",null);return{figmaOauthUrl:null==e?void 0:e.figmaOauthUrl,setSignInWithFigmaModal:t}}},59361:(e,t,a)=>{"use strict";a.d(t,{OnboardingModalInner:()=>N});var l=a(54857),s=a(96541),r=a(3316),n=a(26243),i=a(60885),o=a(16617);function c(e){let{title:t,description:a}=e;return(0,l.jsxs)(r.ModalHeader,{className:"p-0 md:p-0",children:[(0,l.jsx)(r.ModalTitle,{children:t}),(0,l.jsx)(r.ModalDescription,{children:a})]})}var d=a(38651),u=a(37622),m=a(7394),h=a.n(m),x=a(67605);let f=(0,x.createServerReference)("00b5009bc91d173986c1fe70cdc5cdc3b249ac51f3",x.callServer,void 0,x.findSourceMapURL,"setUserAgreementAccepted");var p=a(77170),g=a(77184),j=a(60346),v=a(24048),b=a(19763),y=a(20527);function N(e){var t;let{agreementStatus:a}=e,{user:m}=(0,j.J)(),{refreshScopes:x}=(0,y.b)(),{setShowOnboardingModal:N,showOnboardingModal:w}=(0,n.w)("valid"!==a),[C,k]=(0,s.useTransition)();function S(e){e.preventDefault(),k(async()=>{try{let e=await f();if("SUCCESS"===e){await Promise.all([x(),N(!1)]),await new Promise(e=>setTimeout(e,200)).then(()=>{let e=document.getElementById("chat-main-textarea");null==e||e.focus()});return}if(e&&"error"in e){let t=Error(e.error);e.error===v.zZ&&m&&(0,d.u)("InvariantViolation",{error:"User is authenticated but received UNAUTHENTICATED error",userId:m.id}),(0,p.z)(t)||g.oR.error("Unexpected error. Please try again later.")}}catch(e){(0,p.z)(e)||g.oR.error("Unexpected error. Please try again later.")}})}let I=[{content:(0,l.jsx)(c,{description:(0,l.jsxs)("span",{children:['By clicking "Accept and Continue", you agree to the',"stale"===a?(0,l.jsx)("span",{children:" updated "}):" ",(0,l.jsx)(h(),{className:"text-blue-600",href:"/agreement",rel:"noopener noreferrer",target:"_blank",children:"v0 Terms of Use"}),(0,l.jsx)("span",{children:"."})]}),title:"stale"===a?"v0 Terms of Use Updated":"Accept v0 Terms of Use"},"step5"),actions:(0,l.jsx)(()=>(0,l.jsx)(o.$,{disabled:C,onClick:S,size:"sm",children:C?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.X,{className:"size-4"})," Submitting..."]}):"Accept and Continue"}),{})}],[F,U]=(0,s.useState)("stale"===a?I.length-1:0),M=void 0!==I[F].image;return m?(0,l.jsx)(r.Modal,{className:"w-fit",open:w,responsive:!1,children:(0,l.jsxs)(r.ModalContent,{className:(0,u.cn)("flex w-[320px] flex-col p-0 transition-all duration-300 ease-in-out sm:w-[540px] md:p-0",M?"h-[386px] sm:h-[448px]":"h-[170px]"),children:[M&&(0,l.jsx)("div",{className:"flex border-b sm:h-[248px]",children:I[F].image}),(0,l.jsxs)("div",{className:(0,u.cn)("flex w-full flex-1 flex-col p-6",M?"justify-between":"gap-6"),children:[I[F].content,(0,l.jsxs)("div",{className:(0,u.cn)("flex justify-between",!M&&"justify-end sm:justify-between"),children:[(0,l.jsx)("div",{className:(0,u.cn)("flex items-center justify-center gap-1.5",!M&&"hidden sm:flex","stale"===a&&"invisible"),children:Array.from({length:I.length},(e,t)=>(0,l.jsx)("a",{"aria-label":"Step ".concat(t+1),className:"cursor-pointer rounded-full ".concat(t===F?"h-2 w-2 bg-zinc-500":"h-1.5 w-1.5 bg-zinc-200"," transition-all duration-300 ease-in-out"),onClick:()=>U(t)},t))}),null!==(t=I[F].actions)&&void 0!==t?t:(0,l.jsxs)(o.$,{className:"gap-0.5 px-1.5",onClick:function(){U(F+1)},size:"sm",children:[(0,l.jsx)("p",{className:"px-1.5",children:"Next "}),(0,l.jsx)(i.Q,{})]})]})]})]})}):null}},56720:(e,t,a)=>{"use strict";a.d(t,{f:()=>y});var l=a(54857),s=a(96541),r=a(77184),n=a(62841),i=a(41773),o=a(90761),c=a(38651),d=a(90080),u=a(71368),m=a(67605);let h=(0,m.createServerReference)("403dd5ae966e28633fb56f400013305a89560a31dc",m.callServer,void 0,m.findSourceMapURL,"updateChatPrivacy");var x=a(77170),f=a(51556),p=a(43393),g=a(37622),j=a(82533),v=a(90229),b=a(85035);function y(e){let{privacy:t,variant:a,chatId:u}=e,{isTeam:m,activeScope:f}=(0,p.k6)(),[g,j]=(0,s.useTransition)(),{chatId:v}=(0,n.xz)(),{setChatPrivacy:b}=(0,o.kM)(),{revalidate:y}=(0,i.m)(),{setShareDialog:w,showShareDialog:C}=(0,d.B)(),{ownerId:k}=(0,o.tZ)(),[S,I]=(0,s.useState)(!1),F=!k||k===(null==f?void 0:f.id),U=(0,s.useCallback)(e=>{u===v&&b(e),"object"==typeof C&&w({chatId:u,privacy:e})},[u,v,C,b,w]),M=(0,s.useCallback)(e=>{!g&&u&&e!==t&&(U(e),("public"===e||"team"===e)&&(0,c.u)("ShareChat",{targetChatId:u,team:"team"===e}),j(async()=>{let l=await h({chatId:u,privacy:e});y(),"error"in l?((0,x.z)(Error(l.error))||r.oR.error("Failed to update ".concat("chat"===a?"chat":"chat and block"," privacy")),U(null!=t?t:"private")):r.oR.success("".concat("chat"===a?"Chat":"Chat and block"," privacy updated"))}))},[g,u,t,U,y,a]);return(0,l.jsx)(N,{pending:g,hideWarning:"block"===a,privacy:t,setPrivacy:M,open:S,setOpen:I,isOwnedByCurrentTeam:F,isTeam:m})}function N(e){let{pending:t,privacy:a,setPrivacy:s,open:r,setOpen:n,hideWarning:i,isOwnedByCurrentTeam:o,isTeam:c}=e,d=(0,u.k)("chatPrivacy"),m=o&&("team"===a||"team-edit"===a);return(0,l.jsxs)("div",{className:"flex w-full flex-col justify-between gap-3",children:[(0,l.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,l.jsxs)(j.l6,{disabled:t,value:a,onValueChange:s,open:r,onOpenChange:n,children:[(0,l.jsx)(j.bq,{className:"h-8 w-full rounded-md border border-gray-200 px-2 text-left",children:(0,l.jsx)(j.yv,{placeholder:"Select privacy setting",className:"flex w-full flex-row justify-between",children:a?(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-gray-500",children:f.E[a].icon}),(0,l.jsx)("span",{children:d("title",a)})]}):null})}),(0,l.jsx)(j.gC,{className:"max-w-[95vw]",children:Object.keys(f.E).map(e=>{if((!c||!o)&&("team"===e||"team-edit"===e))return null;let s=f.E[e];return!1===s.visibleInPicker?null:(0,l.jsx)(j.eb,{value:e,className:(0,g.cn)("flex cursor-pointer items-center justify-between p-3 hover:bg-gray-100",a===e&&"bg-gray-100"),onSelect:e=>e.preventDefault(),iconOnRight:!0,icon:t?(0,l.jsx)(v.y,{}):void 0,children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-gray-500",children:s.icon}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:d("title",e)}),(0,l.jsx)("p",{className:"line-clamp-1 text-sm text-gray-500",children:d("description",e)})]})]})},e)})})]}),m&&(0,l.jsxs)(j.l6,{disabled:t,value:a,onValueChange:s,children:[(0,l.jsx)(j.bq,{className:"h-8 min-w-28 max-w-28 rounded-lg border border-gray-200 px-2 text-left text-sm",children:(0,l.jsx)(j.yv,{placeholder:"Select privacy setting",children:(0,l.jsx)("span",{children:d("teamSecondaryOptions",a)})})}),(0,l.jsx)(j.gC,{className:"w-[350px] rounded-lg border border-gray-200 shadow-lg",children:["team","team-edit"].map(e=>(0,l.jsx)(j.eb,{value:e,className:(0,g.cn)("flex cursor-pointer items-center justify-between p-3 hover:bg-gray-100",a===e&&"bg-gray-100"),iconOnRight:!0,icon:t?(0,l.jsx)(v.y,{}):void 0,children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-gray-500",children:f.E[e].icon}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:d("teamSecondaryOptions",e)}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:d("teamSecondaryDescription",e)})]})]})},e))})]})]}),"public"!==a||i?null:(0,l.jsx)(b.$,{})]})}},85035:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var l=a(54857),s=a(45881),r=a(69057);function n(){return(0,l.jsxs)(s.Fc,{variant:"default",className:"relative flex flex-row gap-1 rounded-md border-none bg-gray-100 px-2 py-1.5",children:[(0,l.jsx)("div",{className:"absolute left-[9px] top-[9px] text-gray-500",children:(0,l.jsx)(r.$,{className:"h-4 w-4"})}),(0,l.jsx)(s.TN,{className:"ml-6 text-gray-800",children:"Viewers will have access to all code in this chat, including API keys and credentials."})]})}},3128:(e,t,a)=>{"use strict";a.d(t,{ChatSidebarProvider:()=>d,e:()=>u});var l=a(54857),s=a(96541),r=a(46569),n=a(90080),i=a(30856);let o=function(){let e=localStorage.getItem("sidebar");return document.documentElement.dataset.state="collapsed"===e?"collapsed":"expanded","collapsed"===e?"collapsed":"expanded"},c=(0,s.createContext)({isCollapsed:!1,setCollapsed:()=>{},mobileSheetOpen:!1,setMobileSheetOpen:()=>{},actionChatId:null});function d(e){let{children:t}=e,{ns:a}=(0,i.D)(),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(null),x=(0,s.useCallback)(e=>{h(e),localStorage.setItem("sidebar",e?"collapsed":"expanded"),document.documentElement.dataset.state=e?"collapsed":"expanded"},[]);(0,s.useEffect)(()=>{null===m&&x("collapsed"===localStorage.getItem("sidebar"))},[]);let f=(0,s.useCallback)(e=>{"sidebar"===e.key&&x("collapsed"===o())},[x]);(0,s.useEffect)(()=>(window.addEventListener("storage",f),()=>window.removeEventListener("storage",f)));let{showDeleteDialogForChatId:p}=(0,r.v)(),{showShareDialog:g}=(0,n.B)();return(0,l.jsx)(c.Provider,{value:{isCollapsed:!a&&null!=m&&m,setCollapsed:a?()=>{}:x,mobileSheetOpen:d,setMobileSheetOpen:u,actionChatId:p||("object"==typeof g?g.chatId:null)},children:t})}let u=()=>(0,s.useContext)(c)},37023:(e,t,a)=>{"use strict";a.d(t,{CreateTeamDialog:()=>o,F:()=>i});var l=a(54857),s=a(80612),r=a(3316),n=a(16617);function i(){let{data:e,mutate:t}=(0,s.Ay)("createTeamDialogOpen",null,{fallbackData:!1});return{createTeamDialogOpen:e,setCreateTeamDialogOpen:t}}function o(){let{createTeamDialogOpen:e,setCreateTeamDialogOpen:t}=i();return(0,l.jsxs)(r.Modal,{onOpenChange:t,open:e,children:[(0,l.jsxs)(r.ModalHeader,{children:[(0,l.jsx)(r.ModalTitle,{children:"Create a Team on Vercel"}),(0,l.jsxs)(r.ModalDescription,{children:["You will be redirected to"," ",(0,l.jsx)("span",{className:"font-medium",children:"vercel.com"})," to create a new Vercel team. If you create a Vercel Pro team, you will be charged for the Vercel Pro subscription in addition to the v0 Team plan."]})]}),(0,l.jsxs)(r.ModalFooter,{children:[(0,l.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>t(!1),children:"Cancel"}),(0,l.jsx)(n.$,{size:"sm",asChild:!0,variant:"default",children:(0,l.jsx)("a",{href:"https://vercel.com/dashboard?createTeam=v0-checkout-page",target:"_blank",children:"Continue to Vercel"})})]})]})}},19763:(e,t,a)=>{"use strict";a.d(t,{X:()=>r});var l=a(54857),s=a(37622);function r(e){let{className:t,...a}=e;return(0,l.jsx)("svg",{className:(0,s.cn)("h-4 w-4 animate-spin",t),fill:"currentColor",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,l.jsx)("path",{d:"M232 128a104 104 0 0 1-208 0c0-41 23.81-78.36 60.66-95.27a8 8 0 0 1 6.68 14.54C60.15 61.59 40 93.27 40 128a88 88 0 0 0 176 0c0-34.73-20.15-66.41-51.34-80.73a8 8 0 0 1 6.68-14.54C208.19 49.64 232 87 232 128Z"})})}},68952:(e,t,a)=>{"use strict";a.d(t,{j:()=>r});var l=a(54857),s=a(37622);function r(e){let{count:t,max:a,className:r,displayThreshold:n,alertThreshold:i,message:o,messageThreshold:c,...d}=e;return n=null!=n?n:.75*a,c=null!=c?c:.9*a,i=null!=i?i:.95*a,(0,l.jsxs)("div",{className:(0,s.cn)("pointer-events-none items-center gap-2 rounded-md px-2 py-1 text-xs",t>=n?"flex":"hidden",t>=i?"text-red-500":"text-gray-500",r),...d,children:[o&&t>=c&&(0,l.jsx)("span",{children:o}),(0,l.jsxs)("span",{className:"ml-auto tabular-nums",children:[t.toLocaleString(),"/",a.toLocaleString()]})]})}},67401:(e,t,a)=>{"use strict";a.d(t,{N:()=>o});var l=a(54857),s=a(37622),r=a(7394),n=a.n(r),i=a(26970);function o(e){let{className:t,children:a,variant:r="default",external:o=!1,tooltip:c,disabled:d=!1,...u}=e,m=(0,l.jsx)(n(),{className:(0,s.cn)("marketing"===r&&"font-medium text-teal-700 hover:underline hover:underline-offset-2",d&&"cursor-not-allowed text-gray-400",t),target:o?"_blank":void 0,...u,children:a});return c?("string"==typeof c&&(c={content:c}),(0,l.jsx)(i.Tooltip,{...c,children:m})):m}},82533:(e,t,a)=>{"use strict";a.d(t,{bq:()=>h,eb:()=>g,gC:()=>p,l6:()=>d,s3:()=>u,yv:()=>m});var l=a(54857),s=a(96541),r=a(54148),n=a(37622),i=a(6911),o=a(80798),c=a(2259);let d=r.bL,u=r.YJ,m=r.WT,h=s.forwardRef((e,t)=>{let{className:a,children:s,chevron:o,...c}=e;return(0,l.jsxs)(r.l9,{className:(0,n.cn)("border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:ring-blue-600 flex h-10 w-full items-center justify-between rounded-md border px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),ref:t,...c,children:[s,(0,l.jsx)(r.In,{asChild:!0,children:null!=o?o:(0,l.jsx)(i.y,{className:"size-4 translate-y-[0.5px] text-gray-500 [&_path]:fill-gray-500"})})]})});h.displayName=r.l9.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.PP,{className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),ref:t,...s,children:(0,l.jsx)(o.r,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.wn,{className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),ref:t,...s,children:(0,l.jsx)(i.y,{className:"h-4 w-4"})})});f.displayName=r.wn.displayName;let p=s.forwardRef((e,t)=>{let{className:a,children:s,position:i="popper",...o}=e;return(0,l.jsx)(r.ZL,{children:(0,l.jsxs)(r.UC,{className:(0,n.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md shadow-md","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,ref:t,...o,children:[(0,l.jsx)(x,{}),(0,l.jsx)(r.LM,{className:(0,n.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,l.jsx)(f,{})]})})});p.displayName=r.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.JU,{className:(0,n.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),ref:t,...s})}).displayName=r.JU.displayName;let g=s.forwardRef((e,t)=>{let{className:a,children:s,icon:i,iconOnRight:o,...d}=e;return(0,l.jsxs)(r.q7,{className:(0,n.cn)("focus:bg-accent focus:text-accent-foreground relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),ref:t,...d,children:[(0,l.jsx)("span",{className:(0,n.cn)("absolute flex h-3.5 w-3.5 items-center justify-center",o?"right-2":"left-2"),children:(0,l.jsx)(r.VF,{children:i||(0,l.jsx)(c.J,{className:"h-3 w-3"})})}),(0,l.jsx)(r.p4,{children:s})]})});g.displayName=r.q7.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,l.jsxs)(r.q7,{ref:t,className:(0,n.cn)("focus:bg-accent focus:text-accent-foreground relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,l.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(r.VF,{children:(0,l.jsx)(c.J,{className:"h-4 w-4"})})}),(0,l.jsx)(r.p4,{children:s})]})}).displayName=r.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.wv,{className:(0,n.cn)("bg-muted -mx-1 my-1 h-px",a),ref:t,...s})}).displayName=r.wv.displayName},10373:(e,t,a)=>{"use strict";a.d(t,{Q:()=>n});var l=a(54857),s=a(90229),r=a(16617);function n(e){let{children:t,pending:a,spinnerSide:n="left",...i}=e;return(0,l.jsx)(r.$,{...i,disabled:i.disabled||a,size:"sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[a&&"left"===n?(0,l.jsx)(s.y,{size:16}):null,t,a&&"right"===n?(0,l.jsx)(s.y,{size:16}):null]})})}},95791:(e,t,a)=>{"use strict";a.d(t,{UpdateChatTitleDialog:()=>S,d:()=>k});var l=a(54857),s=a(96541),r=a(16617),n=a(3316),i=a(67605);let o=(0,i.createServerReference)("40a69a453a24df41a4bd0ef6a15914bbef0d36c857",i.callServer,void 0,i.findSourceMapURL,"updateChatTitle");var c=a(90761),d=a(73927),u=a(77184),m=a(86287),h=a(80612),x=a(19763),f=a(3128),p=a(41773),g=a(77170),j=a(24048),v=a(61702),b=a(68952),y=a(71368),N=a(58658),w=a(46159);let C=v.z.object({title:v.z.string().min(1,"Title is required").max(100,"Title must be less than 100 characters")});function k(){let{data:e,mutate:t}=(0,h.Ay)("showUpdateChatTitleDialogForChatId",null);return{showUpdateChatTitleDialogForChatId:e,setUpdateChatTitleDialogForChatId:t}}function S(){let{showUpdateChatTitleDialogForChatId:e,setUpdateChatTitleDialogForChatId:t}=k(),a=(0,d.useRouter)(),[i,h]=(0,s.useTransition)(),{title:v,setMetadata:S}=(0,c.tZ)(),[I,F]=(0,s.useState)(""),U=(0,N.cy)(),{setMobileSheetOpen:M}=(0,f.e)(),{data:z,setData:E}=(0,p.m)(),{data:T,setData:R}=(0,p.r)(),[D,L]=(0,s.useState)(""),O=U.id,P=s.useRef(null),A=(0,y.k)("updateChatTitleDialog"),V=(0,w.al)();(0,s.useEffect)(()=>{t(null)},[t]),(0,s.useEffect)(()=>{if(e){let t=null==z?void 0:z.find(t=>t.chatId===e);L((null==t?void 0:t.title)||v||""),F((null==t?void 0:t.title)||v||"")}},[e,z,v]),(0,s.useEffect)(()=>{e&&setTimeout(()=>{var e,t;null===(e=P.current)||void 0===e||e.focus(),V||null===(t=P.current)||void 0===t||t.select()},0)},[e,V]);let $=(0,s.useCallback)(()=>{e&&h(async()=>{try{let a=null==T?void 0:T.find(t=>t.chatId===e),l=await o({chatId:e,title:I.trim()||"Untitled"});if("success"in l)a&&R(t=>t.map(t=>t.chatId===e?{...t,title:I.trim()||"Untitled"}:t)),(null==z?void 0:z.find(t=>t.chatId===e))&&E(t=>t.map(t=>t.chatId===e?{...t,title:I.trim()||"Untitled"}:t)),O===e&&S({title:I.trim()||"Untitled"}),u.oR.success(A("successToast")),O!==e&&O||M(!1),t(null);else throw Error(j.YK)}catch(e){(0,g.z)(e,a)||u.oR.error("Failed to update chat title. Please try again."),R(()=>T||[]),E(()=>z||[])}})},[e,I,O,a,A,t,S,M]),_=(0,s.useCallback)(()=>{t(null)},[t]),q=(0,s.useCallback)(e=>{e.preventDefault();let t=C.safeParse({title:I});if(!t.success){var a;let e=t.error.flatten().fieldErrors;u.oR.error((null===(a=e.title)||void 0===a?void 0:a[0])||"Invalid title");return}$()},[$,I]);return(0,l.jsx)(n.Modal,{onOpenChange:e=>{e||t(null)},open:null!==e,children:(0,l.jsxs)("form",{onSubmit:q,children:[(0,l.jsxs)(n.ModalHeader,{children:[(0,l.jsx)(n.ModalTitle,{children:A("title")}),(0,l.jsxs)(n.ModalDescription,{children:[(0,l.jsx)("label",{className:"sr-only",htmlFor:"newChatTitle",children:A("newChatTitle")}),(0,l.jsx)(m.p,{"aria-label":A("newChatTitle"),autoComplete:"off",autoFocus:!0,className:"w-full",id:"newChatTitle",maxLength:100,onChange:e=>F(e.target.value),placeholder:D||A("enterNewTitle"),ref:P,value:I}),(0,l.jsx)(b.j,{className:"mt-2",count:I.length,max:100,message:"Title must be less than ".concat(100," characters")})]})]}),(0,l.jsxs)(n.ModalFooter,{children:[(0,l.jsx)(r.$,{onClick:_,size:"sm",type:"button",variant:"secondary",children:A("cancel")}),(0,l.jsx)(r.$,{disabled:i,size:"sm",type:"submit",children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.X,{"aria-hidden":"true",className:"size-4"}),(0,l.jsx)("span",{children:A("saving")})]}):A("save")})]})]})})}},47747:(e,t,a)=>{"use strict";a.d(t,{D:()=>r});var l=a(47303),s=a.n(l);function r(e,t){return t?"".concat(s()(t.slice(0,50)),"-").concat(e):e}},30856:(e,t,a)=>{"use strict";a.d(t,{D:()=>i,FlagsProvider:()=>n});var l=a(54857),s=a(96541);let r=(0,s.createContext)(null);function n(e){let{children:t,promise:a,middlewareFlags:n}=e,i={};for(let e of n)i[e]=!0;let[o,c]=(0,s.useState)(i);return(0,s.useEffect)(()=>{a.then(e=>{(0,s.startTransition)(()=>{c(e)})})},[a]),(0,l.jsx)(r.Provider,{value:o,children:t})}function i(){let e=(0,s.useContext)(r);if(null===e)throw Error("");return e}},13534:(e,t,a)=>{"use strict";a.d(t,{q:()=>o});var l=a(96541),s=a(30856),r=a(80612),n=a(52041);let i=/^https:\/\/www\.figma\.com\/(?:file|design)\/[a-zA-Z0-9]+(?:\/[^\/]+)?\/?\?node-id=[0-9]+-[0-9]+(?:&node-type=(?:frame|component|section))?(?:&t=[a-zA-Z0-9-]+)?(?:&m=dev)?$/;function o(e){let t=(0,s.D)(),{setSignInWithFigmaModal:a}=(0,n.f)(),{data:o,isLoading:c}=(0,r.Ay)("integrations:figma",{fallbackData:{isSignedIn:!1,figmaOauthUrl:""}}),[d,u]=(0,l.useState)({imageBase64:null,originalUrl:null,fileName:null,isScreenshotLoading:!1,isContextLoading:!1,error:null,nodeContext:null}),m=(0,l.useCallback)(e=>t.fi&&!c&&i.test(e),[t.fi,c]),h=(0,l.useCallback)(async t=>{var l,s;let r=t||(null===(l=e.current)||void 0===l?void 0:l.value)||"";if(!r)return{success:!1,reason:"invalid_url"};if(!m(r))return{success:!1,reason:r.includes("figma.com")?"missing_node":"invalid_url"};if(u(e=>({...e,originalUrl:r,isScreenshotLoading:!0})),!(null==o?void 0:o.isSignedIn))return a({figmaOauthUrl:null!==(s=null==o?void 0:o.figmaOauthUrl)&&void 0!==s?s:""}),u(e=>({...e,isScreenshotLoading:!1})),{success:!1,needsAuth:!0};try{let e=await fetch("/chat/api/integrations/figma/get-screenshot?url=".concat(encodeURIComponent(r)));if(401===e.status)return a({figmaOauthUrl:o.figmaOauthUrl}),u(e=>({...e,imageBase64:null,originalUrl:null,fileName:null,isScreenshotLoading:!1,isContextLoading:!1,error:"Authentication required",nodeContext:null})),{success:!1,needsAuth:!0};if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch Figma image")}let t=await e.json(),l=new URL(r).pathname.split("/").pop()||"Figma Design",s={success:!0,data:{base64:t.base64,originalUrl:t.originalUrl,fileName:l}};return u(e=>({...e,imageBase64:t.base64,originalUrl:t.originalUrl,fileName:l,isScreenshotLoading:!1,error:null,nodeContext:JSON.stringify(t,null,0),imageHeight:t.height})),s}catch(t){console.error("Error fetching Figma image:",t);let e=t instanceof Error?t.message:"Failed to fetch image";return u(t=>({...t,imageBase64:null,originalUrl:null,fileName:null,isScreenshotLoading:!1,error:e,nodeContext:null})),{success:!1,error:e}}},[e,m,null==o?void 0:o.isSignedIn,null==o?void 0:o.figmaOauthUrl,a]),x=(0,l.useCallback)(async e=>{try{u(e=>({...e,isContextLoading:!0,error:null}));let t=await fetch("/chat/api/integrations/figma/context?url=".concat(encodeURIComponent(e))),a=await t.json();return u(e=>({...e,isContextLoading:!1,nodeContext:JSON.stringify(a,null,0)})),a}catch(t){let e=t instanceof Error?t.message:"Failed to fetch context";throw u(t=>({...t,isContextLoading:!1,error:e})),t}},[]);return(0,l.useMemo)(()=>{var e;return{...d,isLoading:d.isScreenshotLoading||d.isContextLoading||c,isFigmaLoading:c,handleFigmaUrl:h,isFigmaUrl:m,isSignedIn:!c&&null!==(e=null==o?void 0:o.isSignedIn)&&void 0!==e&&e,userData:o,getNodeContext:x}},[d,h,m,o,x,c])}},12098:(e,t,a)=>{"use strict";a.d(t,{_:()=>s});var l=a(67605);let s=(0,l.createServerReference)("40798155bf396dc4b03cadb578f5e507d07747f693",l.callServer,void 0,l.findSourceMapURL,"deleteChat")},88153:(e,t,a)=>{"use strict";function l(e,[t,a]){return Math.min(a,Math.max(t,e))}a.d(t,{q:()=>l})},96950:(e,t,a)=>{"use strict";a.d(t,{s:()=>u,E:()=>d});var l=a(70214),s=a(56866),r=a(86609);function n(e,t){[...t].reverse().forEach(a=>{let l=e.getVariant(a);l&&(0,s.U)(e,l),e.variantChildren&&e.variantChildren.forEach(e=>{n(e,t)})})}function i(){let e=!1,t=new Set,a={subscribe:e=>(t.add(e),()=>void t.delete(e)),start(a,s){(0,l.V)(e,"controls.start() should only be called after a component has mounted. Consider calling within a useEffect hook.");let n=[];return t.forEach(e=>{n.push((0,r._)(e,a,{transitionOverride:s}))}),Promise.all(n)},set:a=>((0,l.V)(e,"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook."),t.forEach(e=>{Array.isArray(a)?n(e,a):"string"==typeof a?n(e,[a]):(0,s.U)(e,a)})),stop(){t.forEach(e=>{!function(e){e.values.forEach(e=>e.stop())}(e)})},mount:()=>(e=!0,()=>{e=!1,a.stop()})};return a}var o=a(55125),c=a(97286);function d(){let e=(0,o.M)(i);return(0,c.E)(e.mount,[]),e}let u=d},99756:(e,t,a)=>{"use strict";a.d(t,{I:()=>n});var l=a(96541),s=a(48747),r=a(46872);function n(){r.r.current||(0,s.U)();let[e]=(0,l.useState)(r.O.current);return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[666,6846,6697,612,1053,4817,7394,453,1214,8009,5639,6872,7682,943,5756,9112,7163,1702,9431,319,4148,3147,3439,7170,8773,1747,4150,7358],()=>t(46357)),_N_E=e.O()}]);